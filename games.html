<!DOCTYPE html>
<html>

<head>
  <title>CM3315</title>
</head>

<body>
  <nav>
    <a href="./index.html">Main Page</a>
    <a href="./bear.html"> Bears </a>
    <a href="./games.html"> Games </a>
    <a href="./aboutme.html">About Creators</a>
  </nav>
  <br /><br />
  <h3> Current Games </h3>
  <ol> 
  <li></li>
  <li></li>
  </ol>
  <h2> Games </h2>
  <br />
  <p>
  This is a attempt at a game section - comment on what games you want, and I could find the HTML!
  </p>
  <body>
  <html>
    
    

	          <div id="div-gpt-ad-629350160446709561-10" style="margin-bottom:20px;text-align:center;"></div>
	    <!--Start of Preloader call -->
		    <div id="afg_preloader">

			    <div id="container123">

				    <div id="videoplayer">
				      <video id="content123" style="height:1px;width:640px;">
				        <source src="//www.coolmath-games.com/sites/cmatgame/files/adtesting/DummyVideo.mov"></source>
				      </video>
				      <div id="adcontainer" style="height:480px;width:640px;"></div>
				    </div>
				</div>
				      <script type="text/javascript" src="//imasdk.googleapis.com/js/sdkloader/ima3.js"></script>

				  <script type="text/javascript">
				  					  /**
					 * Handles user interaction and creates the player and ads controllers.
					 */
					var Application = function(displayAds) {
						this.playing_ = false;
						this.adsActive_ = false;
						this.adsDone_ = false;
						if(typeof displayAds === 'undefined' || displayAds === null) {
							this.displayAds = true;
						} else {
							this.displayAds = displayAds;
						}

						this.videoPlayer_ = new VideoPlayer();
						if(this.displayAds && typeof targeted_state === 'undefined') {
						  //console.log("Preload ads for non subscription time games");
  						this.ads_ = new Ads(this, this.videoPlayer_);
  						//Adx Preroll Tag with fallback display Ad
              /*
              this.adTagUrl_ = 'https://googleads.g.doubleclick.net/pagead/ads?client=ca-games-pub-9728353415461720&ad_type=video_text_image&description_url=http%3A%2F%2Fwww.coolmath-games.com&max_ad_duration=60000&videoad_start_delay=0';
              */
              this.adTagUrl_ = 'https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/45966600/cmg.preroll&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=[referrer_url]&description_url=http%3A%2F%2Fwww.coolmath-ganes.com&correlator=' + new Date();
              // The user clicked/tapped - inform the ads controller that this code
  						// is being run in a user action thread.
  						this.ads_.initialUserAction();
  						// At the same time, initialize the content player as well.
  						// When content is loaded, we'll issue the ad request to prevent it
  						// from interfering with the initialization. See
  						// https://developers.google.com/interactive-media-ads/docs/sdks/html5/v3/ads#iosvideo
  						// for more information.
  						this.videoPlayer_.preloadContent(this.bind_(this, this.loadAds_));
  						this.adsDone_ = true;
						} else {
						  //console.log("Do not preload ads for free trial user");
						  removeAdSwfJWPLayer();
						}

					};

					Application.prototype.bind_ = function(thisObj, fn) {
					  return function() {
					    fn.apply(thisObj, arguments);
					  };
					};

					Application.prototype.loadAds_ = function() {
					  this.ads_.requestAds(this.adTagUrl_);
					};

					/**
					 * Handles video player functionality.
					 */
					var VideoPlayer = function() {
					  this.contentPlayer = document.getElementById('content123');
					  this.adContainer = document.getElementById('adcontainer');
					  this.videoPlayerContainer_ = document.getElementById('videoplayer');
					  this.width = 640;
					  this.height = 480;
					};

					VideoPlayer.prototype.preloadContent = function(contentLoadedAction) {
					    contentLoadedAction();
					};
					VideoPlayer.prototype.play = function() {
					  this.contentPlayer.play();
					};

					VideoPlayer.prototype.pause = function() {
					  this.contentPlayer.pause();
					};


					/**
					 * Shows how to use the IMA SDK to request and display ads.
					 */
					var Ads = function(application, videoPlayer) {
					  this.application_ = application;
					  this.videoPlayer_ = videoPlayer;
					  this.customClickDiv_ = document.getElementById('customClick');
					  this.contentCompleteCalled_ = false;
					  google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);
					  // Call setLocale() to localize language text and downloaded swfs
					  // google.ima.settings.setLocale('fr');
					  this.adDisplayContainer_ =
					      new google.ima.AdDisplayContainer(
					          this.videoPlayer_.adContainer,
					          this.videoPlayer_.contentPlayer,
					          this.customClickDiv_);
					  this.adsLoader_ = new google.ima.AdsLoader(this.adDisplayContainer_);
					  this.adsManager_ = null;

					  this.adsLoader_.addEventListener(
					      google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,
					      this.onAdsManagerLoaded_,
					      false,
					      this);
					  this.adsLoader_.addEventListener(
					      google.ima.AdErrorEvent.Type.AD_ERROR,
					      this.onAdError_,
					      false,
					      this);
					};

					// On iOS and Android devices, video playback must begin in a user action.
					// AdDisplayContainer provides a initialize() API to be called at appropriate
					// time.
					// This should be called when the user clicks or taps.
					Ads.prototype.initialUserAction = function() {
					  this.adDisplayContainer_.initialize();
					  this.videoPlayer_.contentPlayer.load();

					};

					Ads.prototype.requestAds = function(adTagUrl) {
					  var adsRequest = new google.ima.AdsRequest();
					  adsRequest.adTagUrl = adTagUrl;
					  adsRequest.linearAdSlotWidth = this.videoPlayer_.width;
					  adsRequest.linearAdSlotHeight = this.videoPlayer_.height;
					  adsRequest.nonLinearAdSlotWidth = this.videoPlayer_.width;
					  adsRequest.nonLinearAdSlotHeight = this.videoPlayer_.height;
					  this.adsLoader_.requestAds(adsRequest);
					};

					Ads.prototype.onAdsManagerLoaded_ = function(adsManagerLoadedEvent) {
					  //console.log('Ads loaded.');
					  var adsRenderingSettings = new google.ima.AdsRenderingSettings();
					  //adsRenderingSettings.loadVideoTimeout = 4000;
					  adsRenderingSettings.restoreCustomPlaybackStateOnAdBreakComplete = true;
					  this.adsManager_ = adsManagerLoadedEvent.getAdsManager(
					      this.videoPlayer_.contentPlayer, adsRenderingSettings);
					  this.processAdsManager_(this.adsManager_);
					};

					Ads.prototype.processAdsManager_ = function(adsManager) {
					  if (adsManager.isCustomClickTrackingUsed()) {
					    this.customClickDiv_.style.display = 'table';
					  }
					  // Handle errors.
					  adsManager.addEventListener(
					      google.ima.AdErrorEvent.Type.AD_ERROR,
					      this.onAdError_,
					      false,
					      this);
					  var events = [google.ima.AdEvent.Type.ALL_ADS_COMPLETED,
					                google.ima.AdEvent.Type.COMPLETE,
					                google.ima.AdEvent.Type.FIRST_QUARTILE,
					                google.ima.AdEvent.Type.LOADED,
					                google.ima.AdEvent.Type.MIDPOINT,
					                google.ima.AdEvent.Type.STARTED,
					                google.ima.AdEvent.Type.THIRD_QUARTILE, google.ima.AdEvent.Type.USER_CLOSE];
					  for (var index in events) {
					    adsManager.addEventListener(
					        events[index],
					        this.onAdEvent_,
					        false,
					        this);
					  }

					  var initWidth, initHeight;

					    initWidth = this.videoPlayer_.width;
					    initHeight = this.videoPlayer_.height;

					  adsManager.init(
					    initWidth,
					    initHeight,
					    google.ima.ViewMode.NORMAL);

					  adsManager.start();
					};


					Ads.prototype.onAdEvent_ = function(adEvent) {
					  //console.log('Ad event1: ' + adEvent.type);
					  if (adEvent.type == google.ima.AdEvent.Type.LOADED) {
					  	var ad = adEvent.getAd();
					  	jQuery("#content123").hide();
					  }
					  if (adEvent.type == google.ima.AdEvent.Type.ALL_ADS_COMPLETED) {
					    removeAdSwfJWPLayer();
					  }
					  if (adEvent.type == google.ima.AdEvent.Type.USER_CLOSE) {
					    removeAdSwfJWPLayer();
					  }

					};

					Ads.prototype.onAdError_ = function(adErrorEvent) {
					  //console.log('Ad error: ' + adErrorEvent.getError().toString());
					  if (this.adsManager_) {
					    this.adsManager_.destroy();
					  }
					  //TODO remove the ad slot and display the game
					  //this.application_.resumeAfterAd();
					  removeAdSwfJWPLayer();
					};

					if(typeof subscribeNowAlienClass === 'undefined' || subscribeNowAlienClass === null || subscribeNowAlienClass === '') {
		        subscribeNowAlienClass = "subscribe-now-alien-signup";
		      }
					var cmatgame_subscriber = getCookie('cmg_sx');
					var validSubscriber = false;
				 	if(typeof cmatgame_subscriber !== 'undefined' && cmatgame_subscriber !== null ) {
				 	 validSubscriber = true;
				 	}
					var application = null;
					var freeGamesExceeded = true;
						//display Ads to anonymous users the time from 7am to 13pm, display ads to anonymous users
    				//	from 13pm to 11:59pm and 00 to 7am only if the user is not from New York city
    				//	TODO -->	Need to add day of the week for school hours logic, day < 6 
    				if(getCookie('cmg_schwl') !== null ||  typeof cmg_no_ads !== 'undefined' || (!validSubscriber && schoolHours  || ( !schoolHours && !targetStateUser )  || ( !schoolHours && targetStateUser && getCookie('cmg_active_anonymous_user') !== null) )) {
      				if(getCookie('cmg_schwl') !== null ||  typeof cmg_no_ads !== 'undefined') {
      				  application = new Application(false);
      				} else {
    						application = new Application(true);
      				}
    					if(!/0-chess/.test(window.location.pathname)) {
    						//setCookie('cmg_active_anonymous_user', 'active', 30*60*1000);
    					}
    				} else if(!validSubscriber && !schoolHours && targetStateUser && getCookie('cmg_active_anonymous_user') === null && getCookie('cmg_editor') === null) {
    					//if user comes from google dont show the subscription paywall
    					var ref = document.referrer;
    					//count number of games played by the user this month
    					userPlayedGames = 0;
    					var userFreeGameList = [];
    					var freeGameNid = 11697;
    					if(sessionStorage.getItem("userFreeGameList") !== null) {
  							userFreeGameList = JSON.parse(sessionStorage.getItem("userFreeGameList"));
  						}
    					//if(localStorage.getItem("userPlayedGames"+currentMonth+currentYear) == null) {
    					if((localStorage.getItem("userPlayedGames") == null || getCookie('cmg_upg') === null) && freeGameLimit !== 0) {
    						userPlayedGames = 1;
    						//localStorage.setItem("userPlayedGames"+currentMonth+currentYear,userPlayedGames);
    						localStorage.setItem("userPlayedGames",userPlayedGames);
    						setCookie('cmg_upg', 'true', cmg_upg_days_limit * 24*60*60*1000);
    						userFreeGameList = [freeGameNid];
    						sessionStorage.setItem("userFreeGameList", JSON.stringify(userFreeGameList));
    						application = new Application(false);
    					} else {
    						//userPlayedGames = parseInt(localStorage.getItem("userPlayedGames"+currentMonth+currentYear));//monthly limit
    						if(localStorage.getItem("userPlayedGames") !== null && getCookie('cmg_upg') !== null) {
    							userPlayedGames = parseInt(localStorage.getItem("userPlayedGames"));//lifetime limit
    						} else {
    							userPlayedGames = 0;
    							setCookie('cmg_upg', 'true', cmg_upg_days_limit * 24*60*60*1000);
    						}
    						if(freeGameLimit !== 0 && userPlayedGames < freeGameLimit && userFreeGameList.indexOf(freeGameNid) === -1) {
    							userPlayedGames++;
				 					freeGamesExceeded = false;
    							if(userFreeGameList.length > 0) {
    								userFreeGameList = userFreeGameList.concat(freeGameNid);
    							} else {
    							  userFreeGameList = [freeGameNid];
    							}
    							localStorage.setItem("userPlayedGames",userPlayedGames);
      						sessionStorage.setItem("userFreeGameList", JSON.stringify(userFreeGameList));
    						} else {
    							freeGamesExceeded = true;
    						}

    						var validReferer = false;
    						var validGameSession = false;
    						if(userFreeGameList.indexOf(freeGameNid) > -1) {
    						  validGameSession = true;
    						}
    						if(ref.match("google.com") !== null || ref.match("yahoo.com") !== null || ref.match("bing.com") !== null) {
    						  validReferer = true;
    						}
    						subscriptionSignUpUrl();
    						if(!validReferer && userPlayedGames >= freeGameLimit && !validGameSession) { //subscription paywall
	    						//block anonymous users for New York City from 0-7am and 13pm to 11:59pm
		    					clearInterval(intervalId);
		  						jQuery("#afg_container").remove();
		  						jQuery(".title-instructions").remove();
		  						jQuery(".body-instructions").remove();
                  jQuery(".field-game").html('<div class="subscription-overlay" style="height:360px;width:500px;background:#008aa3;white-space:normal;">'+
                      '<p class="no-free-games-headline">Please Sign up to keep playing</p>' +
                      '<p class="free-in-schools">To keep Coolmath-Games free in schools, <br>we offer subscriptions for unlimited use<br>at home.  '+
                      '<a class="learn-more-link" href="/subscribe-info">  Learn More > </a></p>' +
                      '<a class="'+ subscribeNowAlienClass +'" onclick="subscription_promo_handler();" href="' + signUpURL + ' ">Subscribe Now</a>' +
                      '<p class="already-subscribed">Already a Subscriber? <a class="learn-more-link" href="/user/login">Login</a></p></div>');
		    					//localStorage.setItem("userPlayedGames"+currentMonth+currentYear,userPlayedGames);
		    					//localStorage.setItem("userPlayedGames",userPlayedGames);
    						} else {
    							application = new Application(false);
    							//localStorage.setItem("userPlayedGames"+currentMonth+currentYear,userPlayedGames);//monthly limit
    							//localStorage.setItem("userPlayedGames",userPlayedGames);//lifetime limit
    						}
    					}
    					//display to user how many free games left once page load completes.
    					if (window.addEventListener)
						    window.addEventListener('load', checkPageLoad, false);
						else if (window.attachEvent)
						    window.attachEvent('onload', checkPageLoad);
						else window.onload = checkPageLoad;
    				}

				  </script>
		    </div>
	  <script type="text/javascript">
      function removeAdSwf() {
        removeAdSwfJWPLayer();
      }
      function noAdsReturned() {
      		// enable_preroll_fallback_ads is false
			removeAdSwfJWPLayer();
		      }
	  </script>

	      <div id="continue-container">
	            <div id="continue-link">Continue in </div>
	          <span id="timer_div" style="margin-left:5px;">15</span>
	      </div>
	</div>

  

      
  
 


